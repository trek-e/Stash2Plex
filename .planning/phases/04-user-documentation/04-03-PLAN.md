---
phase: 04-user-documentation
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/config.md
autonomous: true

must_haves:
  truths:
    - "Every user-configurable setting is documented"
    - "Each setting has name, type, default, description, when to change"
    - "Multiple example configurations for different scenarios"
    - "User can tune PlexSync behavior without reading source code"
  artifacts:
    - path: "docs/config.md"
      provides: "Complete configuration reference"
      min_lines: 150
      contains: "plex_url"
  key_links:
    - from: "docs/config.md"
      to: "docs/troubleshoot.md"
      via: "markdown link"
      pattern: "\\[.*\\]\\(troubleshoot\\.md\\)"
---

<objective>
Create comprehensive configuration reference documenting all settings with examples for different scenarios.

Purpose: Enable users to configure PlexSync for their specific needs
Output: docs/config.md
</objective>

<execution_context>
@/Users/trekkie/.claude/get-shit-done/workflows/execute-plan.md
@/Users/trekkie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-user-documentation/04-CONTEXT.md
@.planning/phases/04-user-documentation/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create docs/config.md</name>
  <files>docs/config.md</files>
  <action>
Create docs/config.md with the following structure:

1. **Title**
   - "# Configuration Reference"
   - Brief intro: All PlexSync settings are configured in Stash UI under Settings > Plugins > PlexSync

2. **Required Settings**
   Document these settings first (they have no usable defaults):

   **plex_url** (STRING, required)
   - Description: URL of your Plex Media Server
   - Format: `http://hostname:32400` or `https://hostname:32400`
   - Examples:
     - `http://192.168.1.100:32400` (local network)
     - `http://plex:32400` (Docker container name)
     - `http://host.docker.internal:32400` (Docker to host)
   - Note: Must be reachable from Stash server

   **plex_token** (STRING, required)
   - Description: Plex authentication token
   - How to get: See [Installation Guide](install.md#getting-your-plex-token)
   - Format: Alphanumeric string, typically 20+ characters
   - Security note: Treat like a password, don't share

3. **Recommended Settings**

   **plex_library** (STRING, default: empty)
   - Description: Name of Plex library to search for matches
   - Examples: `"Adult"`, `"Movies"`, `"Home Videos"`
   - When empty: Searches ALL libraries (slower)
   - Recommendation: Set this for faster matching

4. **Behavior Settings**

   **enabled** (BOOLEAN, default: true)
   - Description: Enable or disable PlexSync
   - Use case: Temporarily pause syncing without uninstalling

   **strict_matching** (BOOLEAN, default: true)
   - Description: How to handle multiple Plex matches for a scene
   - When true: Skip sync if multiple matches found (safer)
   - When false: Sync to first match found (may cause incorrect matches)
   - Recommendation: Keep true unless you have unique filenames

   **preserve_plex_edits** (BOOLEAN, default: false)
   - Description: How to handle fields that already have values in Plex
   - When true: Only update empty fields in Plex (preserves manual edits)
   - When false: Overwrite Plex values with Stash values (Stash is source of truth)
   - Use case: Set true if you manually edit metadata in Plex

5. **Performance Settings**

   **max_retries** (NUMBER, default: 5, range: 1-20)
   - Description: Maximum retry attempts for failed sync jobs
   - After max retries: Job moves to dead letter queue
   - Increase if: Network is unreliable
   - Decrease if: You want faster feedback on permanent failures

   **poll_interval** (NUMBER, default: 30, range: 0.1-60)
   - Description: Seconds between queue processing cycles
   - Lower value: Faster syncing, more CPU usage
   - Higher value: Battery/resource friendly, slower syncing
   - Recommendation: 30 is good for most users

   **connect_timeout** (NUMBER, default: 5, range: 1-30)
   - Description: Seconds to wait for initial Plex connection
   - Increase if: Plex is on slow network or remote server

   **read_timeout** (NUMBER, default: 30, range: 5-120)
   - Description: Seconds to wait for Plex API responses
   - Increase if: Large libraries take long to search
   - Decrease if: You want faster failure detection

6. **Internal Settings** (Code-level only)
   Brief mention of settings not in Stash UI but recognized by the code:
   - `strict_mode`: Reject invalid metadata (vs sanitize)
   - `dlq_retention_days`: Days to keep failed jobs (default: 30)
   - Note: These are for advanced users modifying config directly

7. **Example Configurations**

   **Basic Setup** (most users)
   ```yaml
   plex_url: "http://192.168.1.100:32400"
   plex_token: "your-plex-token"
   plex_library: "Adult"
   enabled: true
   ```

   **Preserve Plex Edits** (manual editors)
   ```yaml
   plex_url: "http://192.168.1.100:32400"
   plex_token: "your-plex-token"
   plex_library: "Adult"
   preserve_plex_edits: true
   strict_matching: true
   ```

   **Relaxed Matching** (unique filenames)
   ```yaml
   plex_url: "http://192.168.1.100:32400"
   plex_token: "your-plex-token"
   plex_library: "Adult"
   strict_matching: false
   preserve_plex_edits: false
   ```

   **Unreliable Network**
   ```yaml
   plex_url: "http://remote-plex.example.com:32400"
   plex_token: "your-plex-token"
   plex_library: "Adult"
   max_retries: 15
   connect_timeout: 15
   read_timeout: 60
   ```

   **Docker Setup**
   ```yaml
   plex_url: "http://plex:32400"  # Container name
   plex_token: "your-plex-token"
   plex_library: "Adult"
   ```

8. **Validation Rules**
   - plex_url: Must start with `http://` or `https://`
   - plex_token: Minimum 10 characters
   - Numeric ranges enforced (see above)
   - Invalid config: Plugin logs error and disables

9. **Common Configuration Issues**
   - Wrong URL format -> "plex_url must start with http:// or https://"
   - Token too short -> "plex_token is required"
   - Link to [Troubleshooting](troubleshoot.md) for more
  </action>
  <verify>
    - File exists: `test -f docs/config.md && echo "EXISTS"`
    - Has all required settings: `grep -q "plex_url" docs/config.md && grep -q "plex_token" docs/config.md && echo "HAS_REQUIRED"`
    - Has examples: `grep -c "plex_url:" docs/config.md` (should be 5+ for examples)
    - Has strict_matching: `grep -q "strict_matching" docs/config.md && echo "HAS_STRICT"`
    - Has preserve_plex_edits: `grep -q "preserve_plex_edits" docs/config.md && echo "HAS_PRESERVE"`
    - Links to troubleshoot: `grep -q "troubleshoot.md" docs/config.md && echo "HAS_TROUBLESHOOT_LINK"`
    - Line count: `wc -l docs/config.md` (should be 150-250 lines)
  </verify>
  <done>
docs/config.md exists with:
- All 10 user-configurable settings documented
- Each setting has: name, type, default, description, when to change
- 5+ example configurations for different scenarios
- Validation rules documented
- Links to install.md and troubleshoot.md
  </done>
</task>

</tasks>

<verification>
All checks pass:
- `test -f docs/config.md` returns success
- `grep -q "plex_url" docs/config.md` returns success
- `grep -q "strict_matching" docs/config.md` returns success
- `grep -q "preserve_plex_edits" docs/config.md` returns success
- Example count is 5+
</verification>

<success_criteria>
- Every user-facing setting documented with clear descriptions
- Multiple example configurations cover common scenarios
- Users can configure without reading source code
- Validation rules help users avoid common mistakes
</success_criteria>

<output>
After completion, create `.planning/phases/04-user-documentation/04-03-SUMMARY.md`
</output>
